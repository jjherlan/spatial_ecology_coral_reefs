<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="jjh">
<meta name="dcterms.date" content="2023-05-12">

<title>NOAA quarto simple - Percent Cover and Bleaching in 2015</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Percent Cover and Bleaching in 2015</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="https://raw.githubusercontent.com/nmfs-opensci/assets/main/logo/nmfs-opensci-logo3.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://nmfs-opensci.github.io" title="NMFS Open Science" class="quarto-navigation-tool px-1" aria-label="NMFS Open Science"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/nmfs-opensci" title="NMFS OpenSci" class="quarto-navigation-tool px-1" aria-label="NMFS OpenSci"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/add-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Add content</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/customizing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Customizing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/rendering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rendering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/rmarkdown.Rmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Markdown files</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code in your files</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/percent_cover.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Percent Cover</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/bleaching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Percent Cover &amp; Bleaching</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/bleaching2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Percent Cover &amp; Bleaching Main</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/percent_cover_fieldwork2016.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Percent Cover Transects &amp; Photos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/dispersion_presentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pocilloporid Dispersion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/coral_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Colony Size</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/rpn_sppa2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coral Dispersion II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/rpn_sppa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coral Dispersion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix II</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/bleaching_results_material.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bleaching Supplemental Material</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/research_strategy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Approach</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/soil2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Soil</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#porites" id="toc-porites" class="nav-link active" data-scroll-target="#porites">Porites</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model" id="toc-generalized-linear-model" class="nav-link" data-scroll-target="#generalized-linear-model">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model" id="toc-create-a-post-hoc-model" class="nav-link" data-scroll-target="#create-a-post-hoc-model">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest" id="toc-determine-the-post-hoc-comparisons-of-interest" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#pocillopora" id="toc-pocillopora" class="nav-link" data-scroll-target="#pocillopora">Pocillopora</a></li>
  <li><a href="#pocillopora-1" id="toc-pocillopora-1" class="nav-link" data-scroll-target="#pocillopora-1">Pocillopora</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model-1" id="toc-generalized-linear-model-1" class="nav-link" data-scroll-target="#generalized-linear-model-1">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model-1" id="toc-create-a-post-hoc-model-1" class="nav-link" data-scroll-target="#create-a-post-hoc-model-1">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-1" id="toc-determine-the-post-hoc-comparisons-of-interest-1" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-1">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#pocillopora-bleaching" id="toc-pocillopora-bleaching" class="nav-link" data-scroll-target="#pocillopora-bleaching">Pocillopora Bleaching</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#generalized-linear-model-2" id="toc-generalized-linear-model-2" class="nav-link" data-scroll-target="#generalized-linear-model-2">Generalized linear model</a></li>
  <li><a href="#create-a-post-hoc-model-2" id="toc-create-a-post-hoc-model-2" class="nav-link" data-scroll-target="#create-a-post-hoc-model-2">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-2" id="toc-determine-the-post-hoc-comparisons-of-interest-2" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-2">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#examine-bleaching-response-of-coral-groups" id="toc-examine-bleaching-response-of-coral-groups" class="nav-link" data-scroll-target="#examine-bleaching-response-of-coral-groups">Examine bleaching response of coral groups</a></li>
  <li><a href="#create-a-post-hoc-model-3" id="toc-create-a-post-hoc-model-3" class="nav-link" data-scroll-target="#create-a-post-hoc-model-3">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-3" id="toc-determine-the-post-hoc-comparisons-of-interest-3" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-3">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#pocillopora-2" id="toc-pocillopora-2" class="nav-link" data-scroll-target="#pocillopora-2">Pocillopora</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model-3" id="toc-generalized-linear-model-3" class="nav-link" data-scroll-target="#generalized-linear-model-3">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model-4" id="toc-create-a-post-hoc-model-4" class="nav-link" data-scroll-target="#create-a-post-hoc-model-4">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-4" id="toc-determine-the-post-hoc-comparisons-of-interest-4" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-4">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#macroalgae" id="toc-macroalgae" class="nav-link" data-scroll-target="#macroalgae">Macroalgae</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model-4" id="toc-generalized-linear-model-4" class="nav-link" data-scroll-target="#generalized-linear-model-4">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model-5" id="toc-create-a-post-hoc-model-5" class="nav-link" data-scroll-target="#create-a-post-hoc-model-5">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-5" id="toc-determine-the-post-hoc-comparisons-of-interest-5" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-5">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#turf" id="toc-turf" class="nav-link" data-scroll-target="#turf">Turf</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model-5" id="toc-generalized-linear-model-5" class="nav-link" data-scroll-target="#generalized-linear-model-5">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model-6" id="toc-create-a-post-hoc-model-6" class="nav-link" data-scroll-target="#create-a-post-hoc-model-6">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-6" id="toc-determine-the-post-hoc-comparisons-of-interest-6" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-6">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#sand" id="toc-sand" class="nav-link" data-scroll-target="#sand">Sand</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model-6" id="toc-generalized-linear-model-6" class="nav-link" data-scroll-target="#generalized-linear-model-6">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model-7" id="toc-create-a-post-hoc-model-7" class="nav-link" data-scroll-target="#create-a-post-hoc-model-7">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-7" id="toc-determine-the-post-hoc-comparisons-of-interest-7" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-7">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#bare-substrate" id="toc-bare-substrate" class="nav-link" data-scroll-target="#bare-substrate">Bare substrate</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model-7" id="toc-generalized-linear-model-7" class="nav-link" data-scroll-target="#generalized-linear-model-7">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model-8" id="toc-create-a-post-hoc-model-8" class="nav-link" data-scroll-target="#create-a-post-hoc-model-8">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-8" id="toc-determine-the-post-hoc-comparisons-of-interest-8" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-8">Determine the post-hoc comparisons of interest</a></li>
  <li><a href="#cca-substrate" id="toc-cca-substrate" class="nav-link" data-scroll-target="#cca-substrate">cca substrate</a>
  <ul class="collapse">
  <li><a href="#generalized-linear-model-8" id="toc-generalized-linear-model-8" class="nav-link" data-scroll-target="#generalized-linear-model-8">Generalized linear model</a></li>
  </ul></li>
  <li><a href="#create-a-post-hoc-model-9" id="toc-create-a-post-hoc-model-9" class="nav-link" data-scroll-target="#create-a-post-hoc-model-9">Create a post-hoc model</a></li>
  <li><a href="#determine-the-post-hoc-comparisons-of-interest-9" id="toc-determine-the-post-hoc-comparisons-of-interest-9" class="nav-link" data-scroll-target="#determine-the-post-hoc-comparisons-of-interest-9">Determine the post-hoc comparisons of interest</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/nmfs-opensci/NOAA-quarto-simple/edit/main/content/bleaching_results_supp_material2.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/nmfs-opensci/NOAA-quarto-simple/blob/main/content/bleaching_results_supp_material2.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/nmfs-opensci/NOAA-quarto-simple/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Percent Cover and Bleaching in 2015</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>jjh </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 12, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell" data-inlcude="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>rpn_plob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 8
   location depth transect group total_count total_points cover failures
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt;       &lt;int&gt;        &lt;int&gt; &lt;dbl&gt;    &lt;int&gt;
 1 north    dp    one      PLOB          104          126 0.825       22
 2 north    dp    two      PLOB          113          126 0.897       13
 3 north    sh    one      PLOB           83          126 0.659       43
 4 north    sh    two      PLOB           88          126 0.698       38
 5 se       dp    one      PLOB           34          124 0.274       90
 6 se       dp    two      PLOB           28          105 0.267       77
 7 se       sh    one      PLOB           35          126 0.278       91
 8 se       sh    two      PLOB           15          126 0.119      111
 9 west     dp    one      PLOB           89          126 0.706       37
10 west     dp    two      PLOB           73          126 0.579       53
11 west     sh    one      PLOB           74          126 0.587       52
12 west     sh    two      PLOB          101          126 0.802       25</code></pre>
</div>
</div>
<section id="porites" class="level2">
<h2 class="anchored" data-anchor-id="porites">Porites</h2>
<section id="generalized-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>plob.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_plob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(plob.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plob.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_plob)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            1.8245     0.1822  10.017  &lt; 2e-16 ***
locationse            -2.8154     0.2352 -11.973  &lt; 2e-16 ***
locationwest          -1.2368     0.2246  -5.506 3.68e-08 ***
depthsh               -1.0773     0.2267  -4.753 2.00e-06 ***
locationse:depthsh     0.6719     0.3138   2.142   0.0322 *  
locationwest:depthsh   1.3105     0.2956   4.434 9.25e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 396.020  on 11  degrees of freedom
Residual deviance:  31.694  on  6  degrees of freedom
AIC: 102.95

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(plob.glm, <span class="at">type =</span> <span class="st">'III'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: cbind(total_count, failures)
               LR Chisq Df Pr(&gt;Chisq)    
location        186.616  2  &lt; 2.2e-16 ***
depth            24.219  1  8.599e-07 ***
location:depth   20.391  2  3.735e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>rpn_plob<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_plob<span class="sc">$</span>location, rpn_plob<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model_plob <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_plob, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_plob, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(north.sh) - (west.sh) == 0 -0.07377    0.19208  -0.384    0.795    
(north.sh) - (west.dp) == 0  0.15943    0.18835   0.846    0.795    
(north.sh) - (se.sh) == 0    2.14346    0.20771  10.319  &lt; 2e-16 ***
(north.sh) - (se.dp) == 0    1.73807    0.20078   8.657  &lt; 2e-16 ***
(north.dp) - (west.sh) == 0  1.00357    0.22777   4.406 3.16e-05 ***
(north.dp) - (west.dp) == 0  1.23676    0.22464   5.506 1.47e-07 ***
(north.dp) - (se.sh) == 0    3.22079    0.24110  13.359  &lt; 2e-16 ***
(north.dp) - (se.dp) == 0    2.81541    0.23515  11.973  &lt; 2e-16 ***
(se.sh) - (west.sh) == 0    -2.21723    0.20893 -10.612  &lt; 2e-16 ***
(se.sh) - (west.dp) == 0    -1.98403    0.20551  -9.654  &lt; 2e-16 ***
(se.dp) - (west.sh) == 0    -1.81184    0.20204  -8.968  &lt; 2e-16 ***
(se.dp) - (west.dp) == 0    -1.57865    0.19850  -7.953 8.88e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rpn_plob2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"PLOB"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>rpn_plob2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth  mean      sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0.861 0.0505      2 0.0357     0.407    1.31 
2 north    sh    0.679 0.0281      2 0.0198     0.426    0.931
3 se       dp    0.270 0.00532     2 0.00376    0.223    0.318
4 se       sh    0.198 0.112       2 0.0794    -0.810    1.21 
5 west     dp    0.643 0.0898      2 0.0635    -0.164    1.45 
6 west     sh    0.694 0.152       2 0.107     -0.667    2.06 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>rpn_plob3 <span class="ot">&lt;-</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_plob2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_summ <span class="ot">&lt;-</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    rpn_plob3 <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth  mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0.861 0.0505      2 0.0357     0.407    1.31  North     15 m  
2 north    sh    0.679 0.0281      2 0.0198     0.426    0.931 North     8 m   
3 se       dp    0.270 0.00532     2 0.00376    0.223    0.318 Southeast 15 m  
4 se       sh    0.198 0.112       2 0.0794    -0.810    1.21  Southeast 8 m   
5 west     dp    0.643 0.0898      2 0.0635    -0.164    1.45  West      15 m  
6 west     sh    0.694 0.152       2 0.107     -0.667    2.06  West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_summ.gg <span class="ot">&lt;-</span> rpn_plob_summ <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_summ.gg <span class="ot">&lt;-</span> rpn_plob_summ <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth  mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0.861 0.0505      2 0.0357     0.407    1.31  North     15 m  
2 north    sh    0.679 0.0281      2 0.0198     0.426    0.931 North     8 m   
3 se       dp    0.270 0.00532     2 0.00376    0.223    0.318 Southeast 15 m  
4 se       sh    0.198 0.112       2 0.0794    -0.810    1.21  Southeast 8 m   
5 west     dp    0.643 0.0898      2 0.0635    -0.164    1.45  West      15 m  
6 west     sh    0.694 0.152       2 0.107     -0.667    2.06  West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_plob_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_plob_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">" Pocillopora "</span>), <span class="st">"spp."</span>))) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_bleach <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'PLOB'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'BL'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'PLOB'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'PB'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
# Groups:   location, depth [5]
  location depth transect total_count
  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
1 north    dp    one                5
2 north    dp    two               49
3 north    sh    one               40
4 north    sh    two               31
5 se       dp    two                2
6 west     dp    one               70
7 west     dp    two               55
8 west     sh    one               64
9 west     sh    two               46</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb2 <span class="ot">&lt;-</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(rpn_plob_pb) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'se'</span>, <span class="at">depth =</span> <span class="st">'dp'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'se'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'one'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'se'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb.main <span class="ot">&lt;-</span> rpn_plob_pb2 <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as_tibble() %&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(group == "PLOB") %&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate_at(vars(location, depth, transect, group), factor) %&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span><span class="dv">126</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> <span class="dv">126</span> <span class="sc">-</span> total_count</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb.main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count      cover failures
1     north    dp      one           5 0.03968254      121
2     north    dp      two          49 0.38888889       77
3     north    sh      one          40 0.31746032       86
4     north    sh      two          31 0.24603175       95
5        se    dp      two           2 0.01587302      124
6      west    dp      one          70 0.55555556       56
7      west    dp      two          55 0.43650794       71
8      west    sh      one          64 0.50793651       62
9      west    sh      two          46 0.36507937       80
10       se    dp      two           0 0.00000000      126
11       se    sh      one           0 0.00000000      126
12       se    sh      two           0 0.00000000      126</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pale <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'PLOB'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'P'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
# Groups:   location, depth [6]
   location depth transect total_count
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
 1 north    dp    one               87
 2 north    dp    two               52
 3 north    sh    one               28
 4 north    sh    two               37
 5 se       dp    one               23
 6 se       dp    two                2
 7 se       sh    one               29
 8 se       sh    two                9
 9 west     dp    one               17
10 west     dp    two               16
11 west     sh    one                5
12 west     sh    two               55</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pale.main <span class="ot">&lt;-</span> rpn_plob_pale <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as_tibble() %&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(group == "PLOB") %&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate_at(vars(location, depth, transect, group), factor) %&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span><span class="dv">126</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> <span class="dv">126</span> <span class="sc">-</span> total_count</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pale.main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
# Groups:   location, depth [6]
   location depth transect total_count  cover failures
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 north    dp    one               87 0.690        39
 2 north    dp    two               52 0.413        74
 3 north    sh    one               28 0.222        98
 4 north    sh    two               37 0.294        89
 5 se       dp    one               23 0.183       103
 6 se       dp    two                2 0.0159      124
 7 se       sh    one               29 0.230        97
 8 se       sh    two                9 0.0714      117
 9 west     dp    one               17 0.135       109
10 west     dp    two               16 0.127       110
11 west     sh    one                5 0.0397      121
12 west     sh    two               55 0.437        71</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_healthy <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'PLOB'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'H'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_healthy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   location, depth [6]
   location depth transect total_count
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
 1 north    dp    one               12
 2 north    dp    two               12
 3 north    sh    one               15
 4 north    sh    two               20
 5 se       dp    one               11
 6 se       sh    one                6
 7 se       sh    two                6
 8 west     dp    one                2
 9 west     dp    two                2
10 west     sh    one                5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_healthy2 <span class="ot">&lt;-</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(rpn_plob_healthy) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'se'</span>, <span class="at">depth =</span> <span class="st">'dp'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'west'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_healthy2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count
1     north    dp      one          12
2     north    dp      two          12
3     north    sh      one          15
4     north    sh      two          20
5        se    dp      one          11
6        se    sh      one           6
7        se    sh      two           6
8      west    dp      one           2
9      west    dp      two           2
10     west    sh      one           5
11       se    dp      two           0
12     west    sh      two           0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_healthy.main <span class="ot">&lt;-</span> rpn_plob_healthy2 <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as_tibble() %&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(group == "PLOB") %&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate_at(vars(location, depth, transect, group), factor) %&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span><span class="dv">126</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> <span class="dv">126</span> <span class="sc">-</span> total_count</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_healthy.main </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count      cover failures
1     north    dp      one          12 0.09523810      114
2     north    dp      two          12 0.09523810      114
3     north    sh      one          15 0.11904762      111
4     north    sh      two          20 0.15873016      106
5        se    dp      one          11 0.08730159      115
6        se    sh      one           6 0.04761905      120
7        se    sh      two           6 0.04761905      120
8      west    dp      one           2 0.01587302      124
9      west    dp      two           2 0.01587302      124
10     west    sh      one           5 0.03968254      121
11       se    dp      two           0 0.00000000      126
12     west    sh      two           0 0.00000000      126</code></pre>
</div>
</div>
</section>
<section id="pocillopora" class="level2">
<h2 class="anchored" data-anchor-id="pocillopora">Pocillopora</h2>
<div class="cell" data-incluse="false">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>rpn_bleach <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_bleach_2015.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group, status), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>rpn_bleach</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,512 × 7
   location depth transect point metric group status
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;    &lt;int&gt;  &lt;int&gt; &lt;fct&gt; &lt;fct&gt; 
 1 north    sh    one          1      0 PLOB  PB    
 2 north    sh    one          2     20 PLOB  PB    
 3 north    sh    one          3     40 PLOB  PB    
 4 north    sh    one          4     60 MA    HAL   
 5 north    sh    one          5     80 TURF  na    
 6 north    sh    one          6    100 TURF  na    
 7 north    sh    one          7    120 TURF  na    
 8 north    sh    one          8    140 PLOB  PB    
 9 north    sh    one          9    160 PLOB  PB    
10 north    sh    one         10    180 PLOB  PB    
# ℹ 1,502 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>rpn_summary <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect, group) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth', 'transect'. You can
override using the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>rpn_POCI <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"POCI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>rpn_POCI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
# Groups:   location, depth [6]
   location depth transect total_count
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
 1 north    dp    one                7
 2 north    dp    two                2
 3 north    sh    two                1
 4 se       dp    one               57
 5 se       dp    two               58
 6 se       sh    one               75
 7 se       sh    two               60
 8 west     dp    one               13
 9 west     dp    two               14
10 west     sh    one               15
11 west     sh    two               18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>rpn_poci <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"POCI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-inlcude="false">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>rpn_plob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 9
   location depth transect group total_count total_points cover failures groups 
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt;       &lt;int&gt;        &lt;int&gt; &lt;dbl&gt;    &lt;int&gt; &lt;fct&gt;  
 1 north    dp    one      PLOB          104          126 0.825       22 north.…
 2 north    dp    two      PLOB          113          126 0.897       13 north.…
 3 north    sh    one      PLOB           83          126 0.659       43 north.…
 4 north    sh    two      PLOB           88          126 0.698       38 north.…
 5 se       dp    one      PLOB           34          124 0.274       90 se.dp  
 6 se       dp    two      PLOB           28          105 0.267       77 se.dp  
 7 se       sh    one      PLOB           35          126 0.278       91 se.sh  
 8 se       sh    two      PLOB           15          126 0.119      111 se.sh  
 9 west     dp    one      PLOB           89          126 0.706       37 west.dp
10 west     dp    two      PLOB           73          126 0.579       53 west.dp
11 west     sh    one      PLOB           74          126 0.587       52 west.sh
12 west     sh    two      PLOB          101          126 0.802       25 west.sh</code></pre>
</div>
</div>
</section>
<section id="pocillopora-1" class="level2">
<h2 class="anchored" data-anchor-id="pocillopora-1">Pocillopora</h2>
<section id="generalized-linear-model-1" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-1">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>poci.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_poci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(poci.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poci.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_poci)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -3.2958     0.3395  -9.709  &lt; 2e-16 ***
locationse             3.3046     0.3643   9.072  &lt; 2e-16 ***
locationwest           1.1756     0.3959   2.970  0.00298 ** 
depthsh               -2.2296     1.0579  -2.108  0.03507 *  
locationse:depthsh     2.3640     1.0736   2.202  0.02767 *  
locationwest:depthsh   2.4573     1.0934   2.247  0.02462 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 436.578  on 11  degrees of freedom
Residual deviance:  10.347  on  6  degrees of freedom
AIC: 69.293

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(poci.glm, <span class="at">type =</span> <span class="st">'III'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: cbind(total_count, failures)
               LR Chisq Df Pr(&gt;Chisq)    
location        178.902  2  &lt; 2.2e-16 ***
depth             7.491  1   0.006201 ** 
location:depth    8.513  2   0.014171 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-1" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-1">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>rpn_poci<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_poci<span class="sc">$</span>location, rpn_poci<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model-1" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-1">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>model_poci <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_poci, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-1" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-1">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_poci, </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(north.sh) - (west.sh) == 0  -3.6329     1.0192  -3.564  0.00117 ** 
(north.sh) - (west.dp) == 0  -3.4052     1.0225  -3.330  0.00173 ** 
(north.sh) - (se.sh) == 0    -5.6686     1.0099  -5.613 1.19e-07 ***
(north.sh) - (se.dp) == 0    -5.5342     1.0107  -5.476 2.18e-07 ***
(north.dp) - (west.sh) == 0  -1.4033     0.3874  -3.622  0.00117 ** 
(north.dp) - (west.dp) == 0  -1.1756     0.3959  -2.970  0.00298 ** 
(north.dp) - (se.sh) == 0    -3.4389     0.3622  -9.495  &lt; 2e-16 ***
(north.dp) - (se.dp) == 0    -3.3046     0.3643  -9.072  &lt; 2e-16 ***
(se.sh) - (west.sh) == 0      2.0357     0.2254   9.030  &lt; 2e-16 ***
(se.sh) - (west.dp) == 0      2.2634     0.2397   9.444  &lt; 2e-16 ***
(se.dp) - (west.sh) == 0      1.9013     0.2288   8.311  &lt; 2e-16 ***
(se.dp) - (west.dp) == 0      2.1290     0.2428   8.769  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>rpn_poci2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"POCI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>rpn_poci2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth    mean      sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0.0357  0.0281      2 0.0198   -0.216    0.288 
2 north    sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544
3 se       dp    0.506   0.0656      2 0.0464   -0.0829   1.09  
4 se       sh    0.536   0.0842      2 0.0595   -0.221    1.29  
5 west     dp    0.107   0.00561     2 0.00397   0.0567   0.158 
6 west     sh    0.131   0.0168      2 0.0119   -0.0203   0.282 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rpn_poci3 <span class="ot">&lt;-</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_poci2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ <span class="ot">&lt;-</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    rpn_poci3 <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth    mean      sd     n      se lower.ci upper.ci coast    depth2
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt; 
1 north    dp    0.0357  0.0281      2 0.0198   -0.216    0.288  North    15 m  
2 north    sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544 North    8 m   
3 se       dp    0.506   0.0656      2 0.0464   -0.0829   1.09   Southea… 15 m  
4 se       sh    0.536   0.0842      2 0.0595   -0.221    1.29   Southea… 8 m   
5 west     dp    0.107   0.00561     2 0.00397   0.0567   0.158  West     15 m  
6 west     sh    0.131   0.0168      2 0.0119   -0.0203   0.282  West     8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ.gg <span class="ot">&lt;-</span> rpn_poci_summ <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ.gg <span class="ot">&lt;-</span> rpn_poci_summ <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth    mean      sd     n      se lower.ci upper.ci coast    depth2
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt; 
1 north    dp    0.0357  0.0281      2 0.0198   -0.216    0.288  North    15 m  
2 north    sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544 North    8 m   
3 se       dp    0.506   0.0656      2 0.0464   -0.0829   1.09   Southea… 15 m  
4 se       sh    0.536   0.0842      2 0.0595   -0.221    1.29   Southea… 8 m   
5 west     dp    0.107   0.00561     2 0.00397   0.0567   0.158  West     15 m  
6 west     sh    0.131   0.0168      2 0.0119   -0.0203   0.282  West     8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_poci_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_poci_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggtitle(expression(paste(italic(" Pocillopora "), "spp."))) +</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pocillopora-bleaching" class="level1">
<h1>Pocillopora Bleaching</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'BL'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   location, depth [5]
  location depth transect total_count
  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
1 north    dp    one                1
2 se       dp    one                1
3 se       dp    two                2
4 se       sh    two                1
5 west     dp    one                4
6 west     sh    two                2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach2 <span class="ot">&lt;-</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(rpn_poci_bleach) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'one'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'dp'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'west'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'one'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'west'</span>, <span class="at">depth =</span> <span class="st">'dp'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'se'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count
1     north    dp      one           1
2        se    dp      one           1
3        se    dp      two           2
4        se    sh      two           1
5      west    dp      one           4
6      west    sh      two           2
7     north    sh      one           0
8     north    sh      two           0
9     north    dp      two           0
10     west    sh      one           0
11     west    dp      two           0
12       se    sh      two           0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach.main <span class="ot">&lt;-</span> rpn_poci_bleach2 <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as_tibble() %&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(group == "PLOB") %&gt;%</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate_at(vars(location, depth, transect, group), factor) %&gt;%</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span><span class="dv">126</span>,</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> <span class="dv">126</span> <span class="sc">-</span> total_count</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach.main </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count       cover failures
1     north    dp      one           1 0.007936508      125
2        se    dp      one           1 0.007936508      125
3        se    dp      two           2 0.015873016      124
4        se    sh      two           1 0.007936508      125
5      west    dp      one           4 0.031746032      122
6      west    sh      two           2 0.015873016      124
7     north    sh      one           0 0.000000000      126
8     north    sh      two           0 0.000000000      126
9     north    dp      two           0 0.000000000      126
10     west    sh      one           0 0.000000000      126
11     west    dp      two           0 0.000000000      126
12       se    sh      two           0 0.000000000      126</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'PB'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   location, depth [5]
  location depth transect total_count
  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
1 north    dp    one                2
2 north    dp    two                1
3 se       dp    one               27
4 se       dp    two                9
5 se       sh    one                2
6 se       sh    two                5
7 west     dp    two                2
8 west     sh    one                1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb2 <span class="ot">&lt;-</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(rpn_poci_pb) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'one'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'west'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'west'</span>, <span class="at">depth =</span> <span class="st">'dp'</span>, <span class="at">transect =</span> <span class="st">'one'</span>, <span class="at">total_count =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count
1     north    dp      one           2
2     north    dp      two           1
3        se    dp      one          27
4        se    dp      two           9
5        se    sh      one           2
6        se    sh      two           5
7      west    dp      two           2
8      west    sh      one           1
9     north    sh      one           0
10    north    sh      two           0
11     west    sh      two           0
12     west    dp      one           0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb.main <span class="ot">&lt;-</span> rpn_poci_pb2 <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as_tibble() %&gt;%</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(group == "PLOB") %&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate_at(vars(location, depth, transect, group), factor) %&gt;%</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span><span class="dv">126</span>,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> <span class="dv">126</span> <span class="sc">-</span> total_count</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb.main </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count       cover failures
1     north    dp      one           2 0.015873016      124
2     north    dp      two           1 0.007936508      125
3        se    dp      one          27 0.214285714       99
4        se    dp      two           9 0.071428571      117
5        se    sh      one           2 0.015873016      124
6        se    sh      two           5 0.039682540      121
7      west    dp      two           2 0.015873016      124
8      west    sh      one           1 0.007936508      125
9     north    sh      one           0 0.000000000      126
10    north    sh      two           0 0.000000000      126
11     west    sh      two           0 0.000000000      126
12     west    dp      one           0 0.000000000      126</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'P'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   location, depth [5]
   location depth transect total_count
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
 1 north    dp    one                3
 2 north    dp    two                1
 3 se       dp    one               19
 4 se       dp    two               16
 5 se       sh    one               59
 6 se       sh    two               45
 7 west     dp    one                7
 8 west     dp    two                8
 9 west     sh    one               13
10 west     sh    two                9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale2 <span class="ot">&lt;-</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(rpn_poci_pale) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'one'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count
1     north    dp      one           3
2     north    dp      two           1
3        se    dp      one          19
4        se    dp      two          16
5        se    sh      one          59
6        se    sh      two          45
7      west    dp      one           7
8      west    dp      two           8
9      west    sh      one          13
10     west    sh      two           9
11    north    sh      one           0
12    north    sh      two           0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale.main <span class="ot">&lt;-</span> rpn_poci_pale2 <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as_tibble() %&gt;%</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(group == "PLOB") %&gt;%</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate_at(vars(location, depth, transect, group), factor) %&gt;%</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span><span class="dv">126</span>,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> <span class="dv">126</span> <span class="sc">-</span> total_count</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale.main </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count       cover failures
1     north    dp      one           3 0.023809524      123
2     north    dp      two           1 0.007936508      125
3        se    dp      one          19 0.150793651      107
4        se    dp      two          16 0.126984127      110
5        se    sh      one          59 0.468253968       67
6        se    sh      two          45 0.357142857       81
7      west    dp      one           7 0.055555556      119
8      west    dp      two           8 0.063492063      118
9      west    sh      one          13 0.103174603      113
10     west    sh      two           9 0.071428571      117
11    north    sh      one           0 0.000000000      126
12    north    sh      two           0 0.000000000      126</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_healthy <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'H'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_healthy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
# Groups:   location, depth [6]
  location depth transect total_count
  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
1 north    dp    one                1
2 north    sh    two                1
3 se       dp    one               10
4 se       sh    one               14
5 se       sh    two                9
6 west     dp    one                2
7 west     dp    two                4
8 west     sh    one                1
9 west     sh    two                7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_healthy2 <span class="ot">&lt;-</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(rpn_poci_healthy) <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'sh'</span>, <span class="at">transect =</span> <span class="st">'one'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'north'</span>, <span class="at">depth =</span> <span class="st">'dp'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(<span class="at">location =</span> <span class="st">'se'</span>, <span class="at">depth =</span> <span class="st">'dp'</span>, <span class="at">transect =</span> <span class="st">'two'</span>, <span class="at">total_count =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_healthy.main <span class="ot">&lt;-</span> rpn_poci_healthy2 <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as_tibble() %&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(group == "PLOB") %&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate_at(vars(location, depth, transect, group), factor) %&gt;%</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span><span class="dv">126</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> <span class="dv">126</span> <span class="sc">-</span> total_count</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_healthy.main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count       cover failures
1     north    dp      one           1 0.007936508      125
2     north    sh      two           1 0.007936508      125
3        se    dp      one          10 0.079365079      116
4        se    sh      one          14 0.111111111      112
5        se    sh      two           9 0.071428571      117
6      west    dp      one           2 0.015873016      124
7      west    dp      two           4 0.031746032      122
8      west    sh      one           1 0.007936508      125
9      west    sh      two           7 0.055555556      119
10    north    sh      one           0 0.000000000      126
11    north    dp      two           0 0.000000000      126
12       se    dp      two           0 0.000000000      126</code></pre>
</div>
</div>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
</section>
<section id="generalized-linear-model-2" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-2">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>rpn_poci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 8
   location depth transect group total_count total_points   cover failures
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt;       &lt;int&gt;        &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;
 1 north    dp    one      POCI            7          126 0.0556       119
 2 north    dp    two      POCI            2          126 0.0159       124
 3 north    sh    one      POCI            0          126 0            126
 4 north    sh    two      POCI            1          126 0.00794      125
 5 se       dp    one      POCI           57          124 0.460         67
 6 se       dp    two      POCI           58          105 0.552         47
 7 se       sh    one      POCI           75          126 0.595         51
 8 se       sh    two      POCI           60          126 0.476         66
 9 west     dp    one      POCI           13          126 0.103        113
10 west     dp    two      POCI           14          126 0.111        112
11 west     sh    one      POCI           15          126 0.119        111
12 west     sh    two      POCI           18          126 0.143        108</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>poci.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> rpn_poci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(poci.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poci.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_poci)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -3.2958     0.3395  -9.709  &lt; 2e-16 ***
locationse             3.3046     0.3643   9.072  &lt; 2e-16 ***
locationwest           1.1756     0.3959   2.970  0.00298 ** 
depthsh               -2.2296     1.0579  -2.108  0.03507 *  
locationse:depthsh     2.3640     1.0736   2.202  0.02767 *  
locationwest:depthsh   2.4573     1.0934   2.247  0.02462 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 436.578  on 11  degrees of freedom
Residual deviance:  10.347  on  6  degrees of freedom
AIC: 69.293

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p><code>Anova</code> function from the <code>car</code> package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(poci.glm, <span class="at">type =</span> <span class="st">"III"</span>) <span class="co"># Type III because...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: cbind(total_count, failures)
               LR Chisq Df Pr(&gt;Chisq)    
location        178.902  2  &lt; 2.2e-16 ***
depth             7.491  1   0.006201 ** 
location:depth    8.513  2   0.014171 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-2" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-2">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>rpn_poci<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_poci<span class="sc">$</span>location, rpn_poci<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="create-a-post-hoc-model-2" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-2">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>model_poci <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_poci, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-2" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-2">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_poci, </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(north.sh) - (west.sh) == 0  -3.6329     1.0192  -3.564  0.00117 ** 
(north.sh) - (west.dp) == 0  -3.4052     1.0225  -3.330  0.00173 ** 
(north.sh) - (se.sh) == 0    -5.6686     1.0099  -5.613 1.19e-07 ***
(north.sh) - (se.dp) == 0    -5.5342     1.0107  -5.476 2.18e-07 ***
(north.dp) - (west.sh) == 0  -1.4033     0.3874  -3.622  0.00117 ** 
(north.dp) - (west.dp) == 0  -1.1756     0.3959  -2.970  0.00298 ** 
(north.dp) - (se.sh) == 0    -3.4389     0.3622  -9.495  &lt; 2e-16 ***
(north.dp) - (se.dp) == 0    -3.3046     0.3643  -9.072  &lt; 2e-16 ***
(se.sh) - (west.sh) == 0      2.0357     0.2254   9.030  &lt; 2e-16 ***
(se.sh) - (west.dp) == 0      2.2634     0.2397   9.444  &lt; 2e-16 ***
(se.dp) - (west.sh) == 0      1.9013     0.2288   8.311  &lt; 2e-16 ***
(se.dp) - (west.dp) == 0      2.1290     0.2428   8.769  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'BL'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_bleach</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   location, depth [5]
  location depth transect total_count
  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
1 north    dp    one                1
2 se       dp    one                1
3 se       dp    two                2
4 se       sh    two                1
5 west     dp    one                4
6 west     sh    two                2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'PB'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   location, depth [5]
  location depth transect total_count
  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
1 north    dp    one                2
2 north    dp    two                1
3 se       dp    one               27
4 se       dp    two                9
5 se       sh    one                2
6 se       sh    two                5
7 west     dp    two                2
8 west     sh    one                1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'P'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_pale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   location, depth [5]
   location depth transect total_count
   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
 1 north    dp    one                3
 2 north    dp    two                1
 3 se       dp    one               19
 4 se       dp    two               16
 5 se       sh    one               59
 6 se       sh    two               45
 7 west     dp    one                7
 8 west     dp    two                8
 9 west     sh    one               13
10 west     sh    two                9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_healthy <span class="ot">&lt;-</span> rpn_bleach <span class="sc">%&gt;%</span>  </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">'POCI'</span> <span class="sc">&amp;</span> status <span class="sc">==</span> <span class="st">'H'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth, transect) <span class="sc">%&gt;%</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location', 'depth'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_healthy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
# Groups:   location, depth [6]
  location depth transect total_count
  &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;          &lt;int&gt;
1 north    dp    one                1
2 north    sh    two                1
3 se       dp    one               10
4 se       sh    one               14
5 se       sh    two                9
6 west     dp    one                2
7 west     dp    two                4
8 west     sh    one                1
9 west     sh    two                7</code></pre>
</div>
</div>
</section>
<section id="examine-bleaching-response-of-coral-groups" class="level2">
<h2 class="anchored" data-anchor-id="examine-bleaching-response-of-coral-groups">Examine bleaching response of coral groups</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> rpn_plob_pb.main)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rpn_plob_pb.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rpn_plob_pb.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_plob_pb.main)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            -1.2993     0.1535  -8.463  &lt; 2e-16 ***
locationse             -3.5290     0.7263  -4.859 1.18e-06 ***
locationwest            1.2834     0.1986   6.462 1.03e-10 ***
depthsh                 0.3635     0.2078   1.749   0.0803 .  
locationse:depthsh    -17.0748  1817.2897  -0.009   0.9925    
locationwest:depthsh   -0.6029     0.2742  -2.199   0.0279 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 449.568  on 11  degrees of freedom
Residual deviance:  64.609  on  6  degrees of freedom
AIC: 119.1

Number of Fisher Scoring iterations: 16</code></pre>
</div>
</div>
<p><code>Anova</code> function from the <code>car</code> package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(rpn_plob_pb.glm, <span class="at">type =</span> <span class="st">"III"</span>) <span class="co"># Type III because...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: cbind(total_count, failures)
               LR Chisq Df Pr(&gt;Chisq)    
location        197.689  2    &lt; 2e-16 ***
depth             3.082  1    0.07916 .  
location:depth    7.657  2    0.02174 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb.main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect total_count      cover failures
1     north    dp      one           5 0.03968254      121
2     north    dp      two          49 0.38888889       77
3     north    sh      one          40 0.31746032       86
4     north    sh      two          31 0.24603175       95
5        se    dp      two           2 0.01587302      124
6      west    dp      one          70 0.55555556       56
7      west    dp      two          55 0.43650794       71
8      west    sh      one          64 0.50793651       62
9      west    sh      two          46 0.36507937       80
10       se    dp      two           0 0.00000000      126
11       se    sh      one           0 0.00000000      126
12       se    sh      two           0 0.00000000      126</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-3" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-3">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb.main<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_plob_pb.main<span class="sc">$</span>location, rpn_plob_pb.main<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="create-a-post-hoc-model-3" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-3">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>rpn_plob_pb.lm <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_plob_pb.main, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-3" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-3">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(rpn_plob_pb.lm, </span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(north.sh) - (west.sh) == 0   -0.6805     0.1891  -3.599   0.0016 ** 
(north.sh) - (west.dp) == 0   -0.9199     0.1884  -4.884 7.29e-06 ***
(north.sh) - (se.sh) == 0     20.6038  1817.2895   0.011   1.0000    
(north.sh) - (se.dp) == 0      3.8925     0.7236   5.379 6.73e-07 ***
(north.dp) - (west.sh) == 0   -1.0439     0.1993  -5.239 1.29e-06 ***
(north.dp) - (west.dp) == 0   -1.2834     0.1986  -6.462 1.14e-09 ***
(north.dp) - (se.sh) == 0     20.2403  1817.2895   0.011   1.0000    
(north.dp) - (se.dp) == 0      3.5290     0.7263   4.859 7.29e-06 ***
(se.sh) - (west.sh) == 0     -21.2843  1817.2895  -0.012   1.0000    
(se.sh) - (west.dp) == 0     -21.5238  1817.2895  -0.012   1.0000    
(se.dp) - (west.sh) == 0      -4.5730     0.7212  -6.341 2.29e-09 ***
(se.dp) - (west.dp) == 0      -4.8124     0.7210  -6.674 2.98e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
</section>
<section id="pocillopora-2" class="level2">
<h2 class="anchored" data-anchor-id="pocillopora-2">Pocillopora</h2>
<section id="generalized-linear-model-3" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-3">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>poci.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_poci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(poci.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poci.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_poci)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -3.2958     0.3395  -9.709  &lt; 2e-16 ***
locationse             3.3046     0.3643   9.072  &lt; 2e-16 ***
locationwest           1.1756     0.3959   2.970  0.00298 ** 
depthsh               -2.2296     1.0579  -2.108  0.03507 *  
locationse:depthsh     2.3640     1.0736   2.202  0.02767 *  
locationwest:depthsh   2.4573     1.0934   2.247  0.02462 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 436.578  on 11  degrees of freedom
Residual deviance:  10.347  on  6  degrees of freedom
AIC: 69.293

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-4" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-4">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>rpn_poci<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_poci<span class="sc">$</span>location, rpn_poci<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model-4" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-4">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>model_poci <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_poci, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-4" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-4">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_poci, </span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(north.sh) - (west.sh) == 0  -3.6329     1.0192  -3.564  0.00117 ** 
(north.sh) - (west.dp) == 0  -3.4052     1.0225  -3.330  0.00173 ** 
(north.sh) - (se.sh) == 0    -5.6686     1.0099  -5.613 1.19e-07 ***
(north.sh) - (se.dp) == 0    -5.5342     1.0107  -5.476 2.18e-07 ***
(north.dp) - (west.sh) == 0  -1.4033     0.3874  -3.622  0.00117 ** 
(north.dp) - (west.dp) == 0  -1.1756     0.3959  -2.970  0.00298 ** 
(north.dp) - (se.sh) == 0    -3.4389     0.3622  -9.495  &lt; 2e-16 ***
(north.dp) - (se.dp) == 0    -3.3046     0.3643  -9.072  &lt; 2e-16 ***
(se.sh) - (west.sh) == 0      2.0357     0.2254   9.030  &lt; 2e-16 ***
(se.sh) - (west.dp) == 0      2.2634     0.2397   9.444  &lt; 2e-16 ***
(se.dp) - (west.sh) == 0      1.9013     0.2288   8.311  &lt; 2e-16 ***
(se.dp) - (west.dp) == 0      2.1290     0.2428   8.769  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>rpn_poci2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"POCI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>rpn_poci2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth    mean      sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0.0357  0.0281      2 0.0198   -0.216    0.288 
2 north    sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544
3 se       dp    0.506   0.0656      2 0.0464   -0.0829   1.09  
4 se       sh    0.536   0.0842      2 0.0595   -0.221    1.29  
5 west     dp    0.107   0.00561     2 0.00397   0.0567   0.158 
6 west     sh    0.131   0.0168      2 0.0119   -0.0203   0.282 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>rpn_poci3 <span class="ot">&lt;-</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_poci2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ <span class="ot">&lt;-</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>    rpn_poci3 <span class="sc">%&gt;%</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth    mean      sd     n      se lower.ci upper.ci coast    depth2
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt; 
1 north    dp    0.0357  0.0281      2 0.0198   -0.216    0.288  North    15 m  
2 north    sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544 North    8 m   
3 se       dp    0.506   0.0656      2 0.0464   -0.0829   1.09   Southea… 15 m  
4 se       sh    0.536   0.0842      2 0.0595   -0.221    1.29   Southea… 8 m   
5 west     dp    0.107   0.00561     2 0.00397   0.0567   0.158  West     15 m  
6 west     sh    0.131   0.0168      2 0.0119   -0.0203   0.282  West     8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ.gg <span class="ot">&lt;-</span> rpn_poci_summ <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ.gg <span class="ot">&lt;-</span> rpn_poci_summ <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth    mean      sd     n      se lower.ci upper.ci coast    depth2
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt; 
1 north    dp    0.0357  0.0281      2 0.0198   -0.216    0.288  North    15 m  
2 north    sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544 North    8 m   
3 se       dp    0.506   0.0656      2 0.0464   -0.0829   1.09   Southea… 15 m  
4 se       sh    0.536   0.0842      2 0.0595   -0.221    1.29   Southea… 8 m   
5 west     dp    0.107   0.00561     2 0.00397   0.0567   0.158  West     15 m  
6 west     sh    0.131   0.0168      2 0.0119   -0.0203   0.282  West     8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_poci_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_poci_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggtitle(expression(paste(italic(" Pocillopora "), "spp."))) +</span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb197-28"><a href="#cb197-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb197-29"><a href="#cb197-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>rpn_poci_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-139-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="macroalgae" class="level2">
<h2 class="anchored" data-anchor-id="macroalgae">Macroalgae</h2>
<section id="generalized-linear-model-4" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-4">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>rpn_ma <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"MA"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>ma.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_ma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ma.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-142-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ma.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_ma)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            -2.9957     0.2958 -10.127   &lt;2e-16 ***
locationse            -19.4459  2992.7957  -0.006    0.995    
locationwest           -0.1906     0.4378  -0.435    0.663    
depthsh                -0.3001     0.4503  -0.667    0.505    
locationse:depthsh     17.2163  2992.7959   0.006    0.995    
locationwest:depthsh   -0.2271     0.6911  -0.329    0.742    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 45.822  on 11  degrees of freedom
Residual deviance: 20.051  on  6  degrees of freedom
AIC: 57.317

Number of Fisher Scoring iterations: 17</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-5" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-5">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>rpn_ma<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_ma<span class="sc">$</span>location, rpn_ma<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model-5" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-5">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>model_ma <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_ma, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-5" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-5">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_ma, </span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                             Estimate Std. Error z value Pr(&gt;|z|)
(north.sh) - (west.sh) == 0    0.4177     0.5348   0.781    1.000
(north.sh) - (west.dp) == 0   -0.1095     0.4684  -0.234    1.000
(north.sh) - (se.sh) == 0      2.2296     1.0579   2.108    0.351
(north.sh) - (se.dp) == 0     19.1458  2992.7957   0.006    1.000
(north.dp) - (west.sh) == 0    0.7178     0.5082   1.413    1.000
(north.dp) - (west.dp) == 0    0.1906     0.4378   0.435    1.000
(north.dp) - (se.sh) == 0      2.5297     1.0447   2.421    0.186
(north.dp) - (se.dp) == 0     19.4459  2992.7957   0.006    1.000
(se.sh) - (west.sh) == 0      -1.8119     1.0838  -1.672    0.851
(se.sh) - (west.dp) == 0      -2.3391     1.0527  -2.222    0.289
(se.dp) - (west.sh) == 0     -18.7281  2992.7957  -0.006    1.000
(se.dp) - (west.dp) == 0     -19.2553  2992.7957  -0.006    1.000
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>rpn_ma2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"MA"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>rpn_ma2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth    mean      sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0.0476  0.0112      2 0.00794  -0.0532   0.148 
2 north    sh    0.0357  0.0168      2 0.0119   -0.116    0.187 
3 se       dp    0       0           2 0         0        0     
4 se       sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544
5 west     dp    0.0397  0.0561      2 0.0397   -0.465    0.544 
6 west     sh    0.0238  0.0224      2 0.0159   -0.178    0.225 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>rpn_ma3 <span class="ot">&lt;-</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_ma2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_summ <span class="ot">&lt;-</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>    rpn_ma3 <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth    mean      sd     n      se lower.ci upper.ci coast    depth2
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt; 
1 north    dp    0.0476  0.0112      2 0.00794  -0.0532   0.148  North    15 m  
2 north    sh    0.0357  0.0168      2 0.0119   -0.116    0.187  North    8 m   
3 se       dp    0       0           2 0         0        0      Southea… 15 m  
4 se       sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544 Southea… 8 m   
5 west     dp    0.0397  0.0561      2 0.0397   -0.465    0.544  West     15 m  
6 west     sh    0.0238  0.0224      2 0.0159   -0.178    0.225  West     8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_summ.gg <span class="ot">&lt;-</span> rpn_ma_summ <span class="sc">%&gt;%</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_summ.gg <span class="ot">&lt;-</span> rpn_ma_summ <span class="sc">%&gt;%</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth    mean      sd     n      se lower.ci upper.ci coast    depth2
  &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt; 
1 north    dp    0.0476  0.0112      2 0.00794  -0.0532   0.148  North    15 m  
2 north    sh    0.0357  0.0168      2 0.0119   -0.116    0.187  North    8 m   
3 se       dp    0       0           2 0         0        0      Southea… 15 m  
4 se       sh    0.00397 0.00561     2 0.00397  -0.0465   0.0544 Southea… 8 m   
5 west     dp    0.0397  0.0561      2 0.0397   -0.465    0.544  West     15 m  
6 west     sh    0.0238  0.0224      2 0.0159   -0.178    0.225  West     8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_ma_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_ma_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">" Macrolagae "</span>)))) <span class="sc">+</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>rpn_ma_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-159-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="turf" class="level2">
<h2 class="anchored" data-anchor-id="turf">Turf</h2>
<section id="generalized-linear-model-5" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-5">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>rpn_turf <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"TURF"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>    ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>turf.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_turf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(turf.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-162-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(turf.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_turf)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            -4.4188     0.5808  -7.608 2.78e-14 ***
locationse            -18.0228  2992.7958  -0.006    0.995    
locationwest            0.8635     0.6959   1.241    0.215    
depthsh                 0.7053     0.7128   0.989    0.322    
locationse:depthsh     17.3175  2992.7958   0.006    0.995    
locationwest:depthsh   -0.2368     0.8661  -0.273    0.785    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 34.021  on 11  degrees of freedom
Residual deviance: 16.535  on  6  degrees of freedom
AIC: 52.682

Number of Fisher Scoring iterations: 17</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-6" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-6">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>rpn_turf<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_turf<span class="sc">$</span>location, rpn_turf<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model-6" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-6">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>model_turf <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_turf, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-6" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-6">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_turf, </span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                              Estimate Std. Error z value Pr(&gt;|z|)
(north.sh) - (west.sh) == 0 -6.267e-01  5.155e-01  -1.216    1.000
(north.sh) - (west.dp) == 0 -1.582e-01  5.636e-01  -0.281    1.000
(north.sh) - (se.sh) == 0    7.053e-01  7.128e-01   0.989    1.000
(north.sh) - (se.dp) == 0    1.873e+01  2.993e+03   0.006    1.000
(north.dp) - (west.sh) == 0 -1.332e+00  6.576e-01  -2.026    0.514
(north.dp) - (west.dp) == 0 -8.635e-01  6.959e-01  -1.241    1.000
(north.dp) - (se.sh) == 0    1.567e-15  8.214e-01   0.000    1.000
(north.dp) - (se.dp) == 0    1.802e+01  2.993e+03   0.006    1.000
(se.sh) - (west.sh) == 0    -1.332e+00  6.576e-01  -2.026    0.514
(se.sh) - (west.dp) == 0    -8.635e-01  6.959e-01  -1.241    1.000
(se.dp) - (west.sh) == 0    -1.935e+01  2.993e+03  -0.006    1.000
(se.dp) - (west.dp) == 0    -1.889e+01  2.993e+03  -0.006    1.000
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>rpn_turf2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"TURF"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>rpn_turf2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth   mean      sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0.0119 0.0168      2 0.0119   -0.139    0.163 
2 north    sh    0.0238 0.0224      2 0.0159   -0.178    0.225 
3 se       dp    0      0           2 0         0        0     
4 se       sh    0.0119 0.0168      2 0.0119   -0.139    0.163 
5 west     dp    0.0278 0.00561     2 0.00397  -0.0226   0.0782
6 west     sh    0.0437 0.0393      2 0.0278   -0.309    0.397 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>rpn_turf3 <span class="ot">&lt;-</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_turf2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_summ <span class="ot">&lt;-</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>    rpn_turf3 <span class="sc">%&gt;%</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0.0119 0.0168      2 0.0119   -0.139    0.163  North     15 m  
2 north    sh    0.0238 0.0224      2 0.0159   -0.178    0.225  North     8 m   
3 se       dp    0      0           2 0         0        0      Southeast 15 m  
4 se       sh    0.0119 0.0168      2 0.0119   -0.139    0.163  Southeast 8 m   
5 west     dp    0.0278 0.00561     2 0.00397  -0.0226   0.0782 West      15 m  
6 west     sh    0.0437 0.0393      2 0.0278   -0.309    0.397  West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_summ.gg <span class="ot">&lt;-</span> rpn_turf_summ <span class="sc">%&gt;%</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_summ.gg <span class="ot">&lt;-</span> rpn_turf_summ <span class="sc">%&gt;%</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0.0119 0.0168      2 0.0119   -0.139    0.163  North     15 m  
2 north    sh    0.0238 0.0224      2 0.0159   -0.178    0.225  North     8 m   
3 se       dp    0      0           2 0         0        0      Southeast 15 m  
4 se       sh    0.0119 0.0168      2 0.0119   -0.139    0.163  Southeast 8 m   
5 west     dp    0.0278 0.00561     2 0.00397  -0.0226   0.0782 West      15 m  
6 west     sh    0.0437 0.0393      2 0.0278   -0.309    0.397  West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_turf_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_turf_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggtitle(expression(paste(italic(" turfllopora "), "spp."))) +</span></span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb249-20"><a href="#cb249-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb249-21"><a href="#cb249-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb249-22"><a href="#cb249-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb249-23"><a href="#cb249-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb249-24"><a href="#cb249-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb249-25"><a href="#cb249-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb249-26"><a href="#cb249-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb249-27"><a href="#cb249-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb249-28"><a href="#cb249-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb249-29"><a href="#cb249-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>rpn_turf_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-179-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sand" class="level2">
<h2 class="anchored" data-anchor-id="sand">Sand</h2>
<section id="generalized-linear-model-6" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-6">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>rpn_sand <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"SAND"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>sand.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_sand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sand.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-182-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sand.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_sand)

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            -3.0869     0.3083 -10.012  &lt; 2e-16 ***
locationse            -19.3547  2992.7957  -0.006    0.995    
locationwest            1.4486     0.3524   4.111 3.95e-05 ***
depthsh                 1.6140     0.3482   4.636 3.55e-06 ***
locationse:depthsh     -1.7120  4234.8629   0.000    1.000    
locationwest:depthsh   -2.5407     0.4584  -5.542 2.99e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 161.962  on 11  degrees of freedom
Residual deviance:  28.599  on  6  degrees of freedom
AIC: 72.931

Number of Fisher Scoring iterations: 17</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-7" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-7">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>rpn_sand<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_sand<span class="sc">$</span>location, rpn_sand<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model-7" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-7">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>model_sand <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_sand, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-7" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-7">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_sand, </span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(north.sh) - (west.sh) == 0    1.0921     0.2932   3.724 0.002154 ** 
(north.sh) - (west.dp) == 0    0.1654     0.2351   0.704 1.000000    
(north.sh) - (se.sh) == 0     21.0668  2996.2039   0.007 1.000000    
(north.sh) - (se.dp) == 0     20.9688  2992.7957   0.007 1.000000    
(north.dp) - (west.sh) == 0   -0.5220     0.3936  -1.326 1.000000    
(north.dp) - (west.dp) == 0   -1.4486     0.3524  -4.111 0.000473 ***
(north.dp) - (se.sh) == 0     19.4527  2996.2039   0.006 1.000000    
(north.dp) - (se.dp) == 0     19.3547  2992.7957   0.006 1.000000    
(se.sh) - (west.sh) == 0     -19.9747  2996.2039  -0.007 1.000000    
(se.sh) - (west.dp) == 0     -20.9013  2996.2039  -0.007 1.000000    
(se.dp) - (west.sh) == 0     -19.8767  2992.7957  -0.007 1.000000    
(se.dp) - (west.dp) == 0     -20.8034  2992.7957  -0.007 1.000000    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>rpn_sand2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"SAND"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>rpn_sand2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth   mean      sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0.0437 0.0505      2 0.0357    -0.410    0.497
2 north    sh    0.187  0.00561     2 0.00397    0.136    0.237
3 se       dp    0      0           2 0          0        0    
4 se       sh    0      0           2 0          0        0    
5 west     dp    0.163  0.118       2 0.0833    -0.896    1.22 
6 west     sh    0.0714 0.0561      2 0.0397    -0.433    0.576</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>rpn_sand3 <span class="ot">&lt;-</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_sand2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_summ <span class="ot">&lt;-</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>    rpn_sand3 <span class="sc">%&gt;%</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0.0437 0.0505      2 0.0357    -0.410    0.497 North     15 m  
2 north    sh    0.187  0.00561     2 0.00397    0.136    0.237 North     8 m   
3 se       dp    0      0           2 0          0        0     Southeast 15 m  
4 se       sh    0      0           2 0          0        0     Southeast 8 m   
5 west     dp    0.163  0.118       2 0.0833    -0.896    1.22  West      15 m  
6 west     sh    0.0714 0.0561      2 0.0397    -0.433    0.576 West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_summ.gg <span class="ot">&lt;-</span> rpn_sand_summ <span class="sc">%&gt;%</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_summ.gg <span class="ot">&lt;-</span> rpn_sand_summ <span class="sc">%&gt;%</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0.0437 0.0505      2 0.0357    -0.410    0.497 North     15 m  
2 north    sh    0.187  0.00561     2 0.00397    0.136    0.237 North     8 m   
3 se       dp    0      0           2 0          0        0     Southeast 15 m  
4 se       sh    0      0           2 0          0        0     Southeast 8 m   
5 west     dp    0.163  0.118       2 0.0833    -0.896    1.22  West      15 m  
6 west     sh    0.0714 0.0561      2 0.0397    -0.433    0.576 West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_sand_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_sand_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">" Sand "</span>)))) <span class="sc">+</span></span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb275-22"><a href="#cb275-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb275-23"><a href="#cb275-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb275-24"><a href="#cb275-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb275-25"><a href="#cb275-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb275-26"><a href="#cb275-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb275-27"><a href="#cb275-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb275-28"><a href="#cb275-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb275-29"><a href="#cb275-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>rpn_sand_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-199-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bare-substrate" class="level2">
<h2 class="anchored" data-anchor-id="bare-substrate">Bare substrate</h2>
<section id="generalized-linear-model-7" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-7">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>rpn_bare <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"BARE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>bare.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_bare)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bare.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-202-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bare.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_bare)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)            -22.54    2996.20  -0.008    0.994
locationse              21.16    2996.20   0.007    0.994
locationwest            18.64    2996.20   0.006    0.995
depthsh                 19.97    2996.20   0.007    0.995
locationse:depthsh     -19.89    2996.20  -0.007    0.995
locationwest:depthsh   -38.61    4237.27  -0.009    0.993

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 221.002  on 11  degrees of freedom
Residual deviance:  42.405  on  6  degrees of freedom
AIC: 86.079

Number of Fisher Scoring iterations: 17</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-8" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-8">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>rpn_bare<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_bare<span class="sc">$</span>location, rpn_bare<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model-8" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-8">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>model_bare <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_bare, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-8" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-8">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_bare, </span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(north.sh) - (west.sh) == 0  1.997e+01  2.996e+03   0.007 1.000000    
(north.sh) - (west.dp) == 0  1.335e+00  5.137e-01   2.599 0.074830 .  
(north.sh) - (se.sh) == 0   -1.266e+00  2.888e-01  -4.383 0.000117 ***
(north.sh) - (se.dp) == 0   -1.184e+00  2.950e-01  -4.014 0.000538 ***
(north.dp) - (west.sh) == 0 -6.022e-11  4.237e+03   0.000 1.000000    
(north.dp) - (west.dp) == 0 -1.864e+01  2.996e+03  -0.006 1.000000    
(north.dp) - (se.sh) == 0   -2.124e+01  2.996e+03  -0.007 1.000000    
(north.dp) - (se.dp) == 0   -2.116e+01  2.996e+03  -0.007 1.000000    
(se.sh) - (west.sh) == 0     2.124e+01  2.996e+03   0.007 1.000000    
(se.sh) - (west.dp) == 0     2.601e+00  4.771e-01   5.451 6.01e-07 ***
(se.dp) - (west.sh) == 0     2.116e+01  2.996e+03   0.007 1.000000    
(se.dp) - (west.dp) == 0     2.519e+00  4.809e-01   5.238 1.78e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>rpn_bare2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>rpn_bare2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect  group total_count total_points
1     north    dp      one   BARE           0          126
2     north    dp      one    CCA           0          126
3     north    dp      one     MA           5          126
4     north    dp      one   PLOB         104          126
5     north    dp      one   POCI           7          126
6     north    dp      one   SAND          10          126
7     north    dp      one SPONGE           0          126
8     north    dp      one   TURF           0          126
9     north    dp      two   BARE           0          126
10    north    dp      two    CCA           0          126
11    north    dp      two     MA           7          126
12    north    dp      two   PLOB         113          126
13    north    dp      two   POCI           2          126
14    north    dp      two   SAND           1          126
15    north    dp      two SPONGE           0          126
16    north    dp      two   TURF           3          126
17    north    sh      one   BARE           8          126
18    north    sh      one    CCA           0          126
19    north    sh      one     MA           6          126
20    north    sh      one   PLOB          83          126
21    north    sh      one   POCI           0          126
22    north    sh      one   SAND          24          126
23    north    sh      one SPONGE           0          126
24    north    sh      one   TURF           5          126
25    north    sh      two   BARE          10          126
26    north    sh      two    CCA           0          126
27    north    sh      two     MA           3          126
28    north    sh      two   PLOB          88          126
29    north    sh      two   POCI           1          126
30    north    sh      two   SAND          23          126
31    north    sh      two SPONGE           0          126
32    north    sh      two   TURF           1          126
33       se    dp      one   BARE          33          124
34       se    dp      one    CCA           0          124
35       se    dp      one     MA           0          124
36       se    dp      one   PLOB          34          124
37       se    dp      one   POCI          57          124
38       se    dp      one   SAND           0          124
39       se    dp      one SPONGE           0          124
40       se    dp      one   TURF           0          124
41       se    dp      two   BARE          13          105
42       se    dp      two    CCA           6          105
43       se    dp      two     MA           0          105
44       se    dp      two   PLOB          28          105
45       se    dp      two   POCI          58          105
46       se    dp      two   SAND           0          105
47       se    dp      two SPONGE           0          105
48       se    dp      two   TURF           0          105
49       se    sh      one   BARE           9          126
50       se    sh      one    CCA           4          126
51       se    sh      one     MA           0          126
52       se    sh      one   PLOB          35          126
53       se    sh      one   POCI          75          126
54       se    sh      one   SAND           0          126
55       se    sh      one SPONGE           0          126
56       se    sh      one   TURF           3          126
57       se    sh      two   BARE          45          126
58       se    sh      two    CCA           5          126
59       se    sh      two     MA           1          126
60       se    sh      two   PLOB          15          126
61       se    sh      two   POCI          60          126
62       se    sh      two   SAND           0          126
63       se    sh      two SPONGE           0          126
64       se    sh      two   TURF           0          126
65     west    dp      one   BARE           1          126
66     west    dp      one    CCA           0          126
67     west    dp      one     MA          10          126
68     west    dp      one   PLOB          89          126
69     west    dp      one   POCI          13          126
70     west    dp      one   SAND          10          126
71     west    dp      one SPONGE           0          126
72     west    dp      one   TURF           3          126
73     west    dp      two   BARE           4          126
74     west    dp      two    CCA           0          126
75     west    dp      two     MA           0          126
76     west    dp      two   PLOB          73          126
77     west    dp      two   POCI          14          126
78     west    dp      two   SAND          31          126
79     west    dp      two SPONGE           0          126
80     west    dp      two   TURF           4          126
81     west    sh      one   BARE           0          126
82     west    sh      one    CCA           0          126
83     west    sh      one     MA           5          126
84     west    sh      one   PLOB          74          126
85     west    sh      one   POCI          15          126
86     west    sh      one   SAND          14          126
87     west    sh      one SPONGE           9          126
88     west    sh      one   TURF           9          126
89     west    sh      two   BARE           0          126
90     west    sh      two    CCA           0          126
91     west    sh      two     MA           1          126
92     west    sh      two   PLOB         101          126
93     west    sh      two   POCI          18          126
94     west    sh      two   SAND           4          126
95     west    sh      two SPONGE           0          126
96     west    sh      two   TURF           2          126</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>rpn_bare2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"BARE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>rpn_bare2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth   mean     sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0      0          2 0         0         0    
2 north    sh    0.0714 0.0112     2 0.00794  -0.0294    0.172
3 se       dp    0.195  0.101      2 0.0712   -0.709     1.10 
4 se       sh    0.214  0.202      2 0.143    -1.60      2.03 
5 west     dp    0.0198 0.0168     2 0.0119   -0.131     0.171
6 west     sh    0      0          2 0         0         0    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>rpn_bare3 <span class="ot">&lt;-</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_bare2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_summ <span class="ot">&lt;-</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>    rpn_bare3 <span class="sc">%&gt;%</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean     sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0      0          2 0         0         0     North     15 m  
2 north    sh    0.0714 0.0112     2 0.00794  -0.0294    0.172 North     8 m   
3 se       dp    0.195  0.101      2 0.0712   -0.709     1.10  Southeast 15 m  
4 se       sh    0.214  0.202      2 0.143    -1.60      2.03  Southeast 8 m   
5 west     dp    0.0198 0.0168     2 0.0119   -0.131     0.171 West      15 m  
6 west     sh    0      0          2 0         0         0     West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_summ.gg <span class="ot">&lt;-</span> rpn_bare_summ <span class="sc">%&gt;%</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_summ.gg <span class="ot">&lt;-</span> rpn_bare_summ <span class="sc">%&gt;%</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean     sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0      0          2 0         0         0     North     15 m  
2 north    sh    0.0714 0.0112     2 0.00794  -0.0294    0.172 North     8 m   
3 se       dp    0.195  0.101      2 0.0712   -0.709     1.10  Southeast 15 m  
4 se       sh    0.214  0.202      2 0.143    -1.60      2.03  Southeast 8 m   
5 west     dp    0.0198 0.0168     2 0.0119   -0.131     0.171 West      15 m  
6 west     sh    0      0          2 0         0         0     West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_bare_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_bare_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">" Bare "</span>)))) <span class="sc">+</span></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb304-16"><a href="#cb304-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb304-17"><a href="#cb304-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb304-18"><a href="#cb304-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb304-19"><a href="#cb304-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb304-20"><a href="#cb304-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb304-21"><a href="#cb304-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb304-22"><a href="#cb304-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb304-23"><a href="#cb304-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb304-24"><a href="#cb304-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb304-25"><a href="#cb304-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb304-26"><a href="#cb304-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb304-27"><a href="#cb304-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb304-28"><a href="#cb304-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb304-29"><a href="#cb304-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>rpn_bare_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-221-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cca-substrate" class="level2">
<h2 class="anchored" data-anchor-id="cca-substrate">cca substrate</h2>
<section id="generalized-linear-model-8" class="level3">
<h3 class="anchored" data-anchor-id="generalized-linear-model-8">Generalized linear model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>rpn_cca <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"CCA"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>cca.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> location <span class="sc">*</span> depth, </span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> rpn_cca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cca.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-224-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cca.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(total_count, failures) ~ location * depth, 
    family = binomial(link = "logit"), data = rpn_cca)

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)          -2.454e+01  8.145e+03  -0.003    0.998
locationse            2.092e+01  8.145e+03   0.003    0.998
locationwest         -9.358e-09  1.152e+04   0.000    1.000
depthsh              -2.366e-08  1.152e+04   0.000    1.000
locationse:depthsh    3.196e-01  1.152e+04   0.000    1.000
locationwest:depthsh  2.365e-08  1.629e+04   0.000    1.000

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 44.2469  on 11  degrees of freedom
Residual deviance:  9.6636  on  6  degrees of freedom
AIC: 31.936

Number of Fisher Scoring iterations: 19</code></pre>
</div>
</div>
<section id="httpswww.rpubs.comdaharo_calpoly502695-9" class="level4">
<h4 class="anchored" data-anchor-id="httpswww.rpubs.comdaharo_calpoly502695-9">https://www.rpubs.com/daharo_calpoly/502695</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>rpn_cca<span class="sc">$</span>groups <span class="ot">&lt;-</span> <span class="fu">interaction</span>(rpn_cca<span class="sc">$</span>location, rpn_cca<span class="sc">$</span>depth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="create-a-post-hoc-model-9" class="level2">
<h2 class="anchored" data-anchor-id="create-a-post-hoc-model-9">Create a post-hoc model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>model_cca <span class="ot">&lt;-</span> <span class="fu">with</span>(rpn_cca, <span class="fu">glm</span>(<span class="fu">cbind</span>(total_count, failures) <span class="sc">~</span> groups, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-the-post-hoc-comparisons-of-interest-9" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-post-hoc-comparisons-of-interest-9">Determine the post-hoc comparisons of interest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model_cca, </span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">groups =</span></span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#Is the difference between these groups different from zero?</span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"(north.sh) - (west.sh) = 0"</span>,</span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (west.dp) = 0"</span>,</span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.sh) = 0"</span>,</span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.sh) - (se.dp) = 0"</span>,</span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.sh) = 0"</span>,</span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (west.dp) = 0"</span>,</span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.sh) = 0"</span>,</span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(north.dp) - (se.dp) = 0"</span>,</span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.sh) = 0"</span>,</span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.sh) - (west.dp) = 0"</span>,</span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.sh) = 0"</span>,</span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"(se.dp) - (west.dp) = 0"</span>))),</span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: glm(formula = cbind(total_count, failures) ~ groups, family = binomial)

Linear Hypotheses:
                              Estimate Std. Error z value Pr(&gt;|z|)
(north.sh) - (west.sh) == 0  3.412e-12  1.152e+04   0.000        1
(north.sh) - (west.dp) == 0  3.501e-15  1.152e+04   0.000        1
(north.sh) - (se.sh) == 0   -2.124e+01  8.145e+03  -0.003        1
(north.sh) - (se.dp) == 0   -2.092e+01  8.145e+03  -0.003        1
(north.dp) - (west.sh) == 0 -1.819e-08  1.152e+04   0.000        1
(north.dp) - (west.dp) == 0 -1.819e-08  1.152e+04   0.000        1
(north.dp) - (se.sh) == 0   -2.124e+01  8.145e+03  -0.003        1
(north.dp) - (se.dp) == 0   -2.092e+01  8.145e+03  -0.003        1
(se.sh) - (west.sh) == 0     2.124e+01  8.145e+03   0.003        1
(se.sh) - (west.dp) == 0     2.124e+01  8.145e+03   0.003        1
(se.dp) - (west.sh) == 0     2.092e+01  8.145e+03   0.003        1
(se.dp) - (west.dp) == 0     2.092e+01  8.145e+03   0.003        1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>rpn_cca2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>rpn_cca2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   location depth transect  group total_count total_points
1     north    dp      one   BARE           0          126
2     north    dp      one    CCA           0          126
3     north    dp      one     MA           5          126
4     north    dp      one   PLOB         104          126
5     north    dp      one   POCI           7          126
6     north    dp      one   SAND          10          126
7     north    dp      one SPONGE           0          126
8     north    dp      one   TURF           0          126
9     north    dp      two   BARE           0          126
10    north    dp      two    CCA           0          126
11    north    dp      two     MA           7          126
12    north    dp      two   PLOB         113          126
13    north    dp      two   POCI           2          126
14    north    dp      two   SAND           1          126
15    north    dp      two SPONGE           0          126
16    north    dp      two   TURF           3          126
17    north    sh      one   BARE           8          126
18    north    sh      one    CCA           0          126
19    north    sh      one     MA           6          126
20    north    sh      one   PLOB          83          126
21    north    sh      one   POCI           0          126
22    north    sh      one   SAND          24          126
23    north    sh      one SPONGE           0          126
24    north    sh      one   TURF           5          126
25    north    sh      two   BARE          10          126
26    north    sh      two    CCA           0          126
27    north    sh      two     MA           3          126
28    north    sh      two   PLOB          88          126
29    north    sh      two   POCI           1          126
30    north    sh      two   SAND          23          126
31    north    sh      two SPONGE           0          126
32    north    sh      two   TURF           1          126
33       se    dp      one   BARE          33          124
34       se    dp      one    CCA           0          124
35       se    dp      one     MA           0          124
36       se    dp      one   PLOB          34          124
37       se    dp      one   POCI          57          124
38       se    dp      one   SAND           0          124
39       se    dp      one SPONGE           0          124
40       se    dp      one   TURF           0          124
41       se    dp      two   BARE          13          105
42       se    dp      two    CCA           6          105
43       se    dp      two     MA           0          105
44       se    dp      two   PLOB          28          105
45       se    dp      two   POCI          58          105
46       se    dp      two   SAND           0          105
47       se    dp      two SPONGE           0          105
48       se    dp      two   TURF           0          105
49       se    sh      one   BARE           9          126
50       se    sh      one    CCA           4          126
51       se    sh      one     MA           0          126
52       se    sh      one   PLOB          35          126
53       se    sh      one   POCI          75          126
54       se    sh      one   SAND           0          126
55       se    sh      one SPONGE           0          126
56       se    sh      one   TURF           3          126
57       se    sh      two   BARE          45          126
58       se    sh      two    CCA           5          126
59       se    sh      two     MA           1          126
60       se    sh      two   PLOB          15          126
61       se    sh      two   POCI          60          126
62       se    sh      two   SAND           0          126
63       se    sh      two SPONGE           0          126
64       se    sh      two   TURF           0          126
65     west    dp      one   BARE           1          126
66     west    dp      one    CCA           0          126
67     west    dp      one     MA          10          126
68     west    dp      one   PLOB          89          126
69     west    dp      one   POCI          13          126
70     west    dp      one   SAND          10          126
71     west    dp      one SPONGE           0          126
72     west    dp      one   TURF           3          126
73     west    dp      two   BARE           4          126
74     west    dp      two    CCA           0          126
75     west    dp      two     MA           0          126
76     west    dp      two   PLOB          73          126
77     west    dp      two   POCI          14          126
78     west    dp      two   SAND          31          126
79     west    dp      two SPONGE           0          126
80     west    dp      two   TURF           4          126
81     west    sh      one   BARE           0          126
82     west    sh      one    CCA           0          126
83     west    sh      one     MA           5          126
84     west    sh      one   PLOB          74          126
85     west    sh      one   POCI          15          126
86     west    sh      one   SAND          14          126
87     west    sh      one SPONGE           9          126
88     west    sh      one   TURF           9          126
89     west    sh      two   BARE           0          126
90     west    sh      two    CCA           0          126
91     west    sh      two     MA           1          126
92     west    sh      two   PLOB         101          126
93     west    sh      two   POCI          18          126
94     west    sh      two   SAND           4          126
95     west    sh      two SPONGE           0          126
96     west    sh      two   TURF           2          126</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>rpn_cca2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'rpn_cover.csv'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"CCA"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(location, depth, transect, group), factor) <span class="sc">%&gt;%</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cover =</span> total_count<span class="sc">/</span>total_points,</span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">failures =</span> total_points <span class="sc">-</span> total_count</span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, depth) <span class="sc">%&gt;%</span></span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(cover), </span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(cover), </span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower.ci =</span> mean <span class="sc">-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se,</span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper.ci =</span> mean <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'location'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>rpn_cca2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   location [3]
  location depth   mean      sd     n      se lower.ci upper.ci
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 north    dp    0      0           2 0         0        0     
2 north    sh    0      0           2 0         0        0     
3 se       dp    0.0286 0.0404      2 0.0286   -0.334    0.392 
4 se       sh    0.0357 0.00561     2 0.00397  -0.0147   0.0861
5 west     dp    0      0           2 0         0        0     
6 west     sh    0      0           2 0         0        0     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>rpn_cca3 <span class="ot">&lt;-</span></span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(rpn_cca2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_summ <span class="ot">&lt;-</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>    rpn_cca3 <span class="sc">%&gt;%</span></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">coast =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'Southeast'</span>, <span class="st">'West'</span>), <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">depth2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'15 m'</span>, <span class="st">'8 m'</span>), <span class="at">times =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(coast, depth2), factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_summ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0      0           2 0         0        0      North     15 m  
2 north    sh    0      0           2 0         0        0      North     8 m   
3 se       dp    0.0286 0.0404      2 0.0286   -0.334    0.392  Southeast 15 m  
4 se       sh    0.0357 0.00561     2 0.00397  -0.0147   0.0861 Southeast 8 m   
5 west     dp    0      0           2 0         0        0      West      15 m  
6 west     sh    0      0           2 0         0        0      West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_summ.gg <span class="ot">&lt;-</span> rpn_cca_summ <span class="sc">%&gt;%</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)),</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_summ.gg <span class="ot">&lt;-</span> rpn_cca_summ <span class="sc">%&gt;%</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coast =</span> <span class="fu">factor</span>(coast, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'North'</span>, <span class="st">'West'</span>, <span class="st">'Southeast'</span>)),</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">depth2 =</span> <span class="fu">factor</span>(depth2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'8 m'</span>, <span class="st">'15 m'</span>)</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_summ.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  location depth   mean      sd     n      se lower.ci upper.ci coast     depth2
  &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; 
1 north    dp    0      0           2 0         0        0      North     15 m  
2 north    sh    0      0           2 0         0        0      North     8 m   
3 se       dp    0.0286 0.0404      2 0.0286   -0.334    0.392  Southeast 15 m  
4 se       sh    0.0357 0.00561     2 0.00397  -0.0147   0.0861 Southeast 8 m   
5 west     dp    0      0           2 0         0        0      West      15 m  
6 west     sh    0      0           2 0         0        0      West      8 m   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>x_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"West"</span>, <span class="st">"Southeast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>label_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"8 m"</span> <span class="ot">=</span> <span class="st">"8 m"</span>, <span class="st">"15 m"</span> <span class="ot">=</span> <span class="st">"15 m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_cca_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> coast, <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span> </span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_2015.ggbarplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rpn_cca_summ.gg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(coast, x_labels), <span class="at">y =</span> mean, <span class="at">fill =</span> coast)) <span class="sc">+</span>   </span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.50</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean, <span class="at">ymax =</span> mean <span class="sc">+</span> sd), <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Percent Cover"</span>)), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.0</span>), </span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x<span class="sc">*</span><span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> x_labels) <span class="sc">+</span> </span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFC74E"</span>, <span class="st">"#82A5C0"</span>, <span class="st">"#ABC178"</span>)) <span class="sc">+</span> <span class="co">#</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> depth2, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(label_names), <span class="at">dir =</span> <span class="st">"v"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ggtitle(expression(paste(italic(" ccallopora "), "spp."))) +</span></span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = cld, y = upper.ci), vjust = -0.5, size = 10) +</span></span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_log10(expression(paste("Colony Size (", cm^2, ")"), limits = c(0, 100000))) +</span></span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">hjust =</span> <span class="fl">0.50</span>),</span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),    </span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb333-18"><a href="#cb333-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb333-19"><a href="#cb333-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb333-20"><a href="#cb333-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb333-21"><a href="#cb333-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb333-22"><a href="#cb333-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb333-23"><a href="#cb333-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb333-24"><a href="#cb333-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb333-25"><a href="#cb333-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb333-26"><a href="#cb333-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb333-27"><a href="#cb333-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb333-28"><a href="#cb333-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb333-29"><a href="#cb333-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>rpn_cca_2015.ggbarplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-243-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>rpn_crw <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">'rpn_crw.txt'</span>, <span class="at">delim =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...8`
• `` -&gt; `...9`
• `` -&gt; `...10`
• `` -&gt; `...11`
• `` -&gt; `...13`
• `` -&gt; `...14`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 14005 Columns: 17
── Column specification ────────────────────────────────────────────────────────
Delimiter: " "
chr (3): MM, DD, BAA_7day_max
dbl (6): YYYY, SST_MIN, SST_MAX, SST, ...11, 90th_HS
lgl (8):        SSTA    , ...8, ...9, ...10, ...13, ...14, DHW,         

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>#<code>{r} #rpn_crw.main &lt;- write_csv(rpn_crw, 'rpn_crw.csv') #</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'rpn_crw.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 14005 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (7): year, month, day, sst_min, sst_max, sst, dhw

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14,005 × 7
    year month   day sst_min sst_max   sst   dhw
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  1985     1     1    24.1    24.2  24.1     0
 2  1985     1     2    24.2    24.3  24.2     0
 3  1985     1     3    24.3    24.3  24.3     0
 4  1985     1     4    24.4    24.4  24.4     0
 5  1985     1     5    24.5    24.6  24.5     0
 6  1985     1     6    25.2    25.3  25.3     0
 7  1985     1     7    25.0    25.2  25.2     0
 8  1985     1     8    25.7    25.9  25.9     0
 9  1985     1     9    26      26.2  26.2     0
10  1985     1    10    26.2    26.3  26.3     0
# ℹ 13,995 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main2 <span class="ot">&lt;-</span> </span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>  rpn_crw.main <span class="sc">%&gt;%</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">make_date</span>(year, month, day)) </span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a><span class="co">#%&gt;%</span></span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter(date &gt; 2015-01-01)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14,005 × 8
    year month   day sst_min sst_max   sst   dhw date      
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;    
 1  1985     1     1    24.1    24.2  24.1     0 1985-01-01
 2  1985     1     2    24.2    24.3  24.2     0 1985-01-02
 3  1985     1     3    24.3    24.3  24.3     0 1985-01-03
 4  1985     1     4    24.4    24.4  24.4     0 1985-01-04
 5  1985     1     5    24.5    24.6  24.5     0 1985-01-05
 6  1985     1     6    25.2    25.3  25.3     0 1985-01-06
 7  1985     1     7    25.0    25.2  25.2     0 1985-01-07
 8  1985     1     8    25.7    25.9  25.9     0 1985-01-08
 9  1985     1     9    26      26.2  26.2     0 1985-01-09
10  1985     1    10    26.2    26.3  26.3     0 1985-01-10
# ℹ 13,995 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main3 <span class="ot">&lt;-</span> </span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>  rpn_crw.main2 <span class="sc">%&gt;%</span></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="st">'2014-01-01'</span>,</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>         date <span class="sc">&lt;=</span> <span class="st">'2015-12-31'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sst_max, dhw, date) <span class="sc">%&gt;%</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>date, <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,460 × 3
   date       metric  value
   &lt;date&gt;     &lt;chr&gt;   &lt;dbl&gt;
 1 2014-01-01 sst_max  24.3
 2 2014-01-01 dhw       0  
 3 2014-01-02 sst_max  23.9
 4 2014-01-02 dhw       0  
 5 2014-01-03 sst_max  23.8
 6 2014-01-03 dhw       0  
 7 2014-01-04 sst_max  23.7
 8 2014-01-04 dhw       0  
 9 2014-01-05 sst_max  23.8
10 2014-01-05 dhw       0  
# ℹ 1,450 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main4 <span class="ot">&lt;-</span> </span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>  rpn_crw.main3 <span class="sc">%&gt;%</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> metric, <span class="at">values_from =</span> value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 730 × 3
   date       sst_max   dhw
   &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 2014-01-01    24.3     0
 2 2014-01-02    23.9     0
 3 2014-01-03    23.8     0
 4 2014-01-04    23.7     0
 5 2014-01-05    23.8     0
 6 2014-01-06    24.0     0
 7 2014-01-07    24.2     0
 8 2014-01-08    24.4     0
 9 2014-01-09    24.4     0
10 2014-01-10    24.4     0
# ℹ 720 more rows</code></pre>
</div>
</div>
<!-- #```{r} -->
<!-- # Using ggplot -->
<!-- #ggplot(data = rpn_crw.main4, aes(x = date, y = sst_max)) + -->
<!-- #  geom_line() + -->
<!-- #  geom_smooth(se = FALSE) + -->
<!-- #  labs(y = "Temperature") %>% -->
<!-- #  scale_x_datetime(date_breaks = "year", date_labels = "%b-%Y") -->
<!-- #    geom_line(aes(y = dhw)) + -->
<!--   scale_y_continuous( -->
<!--     # Features of the first axis -->
<!--     name = "Temperature", -->
<!--     # Add a second axis and specify its features -->
<!--     sec.axis = ggplot2::sec_axis(dhw) -->
<!--   ) -->
<!-- ``` -->
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create long labels to be wrapped</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">=</span> <span class="fu">paste</span>(iris<span class="sc">$</span>Species, </span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"random text to make the labels much much longer than the original labels"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main.gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> rpn_crw.main4, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> sst_max)) <span class="sc">+</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"SST Max (°C)"</span>)) <span class="sc">+</span></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylim(0, 30) +</span></span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_fill_discrete(name = "Dose", labels = c("A", "B")) +</span></span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> dhw, <span class="at">color =</span> <span class="st">"Degree Heating Week"</span>)) <span class="sc">+</span></span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_continuous(breaks = seq(0, 336, 24)) +</span></span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %y"</span>) <span class="sc">+</span></span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red2"</span>, <span class="st">"blue"</span>))<span class="sc">+</span></span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#strip.text = element_text(size = 10, color = "black", hjust = 0.50),</span></span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">#strip.background = element_rect(fill = "#FFFFFF", color = NA),    </span></span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#FFFFFF"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb353-14"><a href="#cb353-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb353-15"><a href="#cb353-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb353-16"><a href="#cb353-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb353-17"><a href="#cb353-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#b2b2b2"</span>),</span>
<span id="cb353-18"><a href="#cb353-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">#panel.spacing.x = unit(1, "cm"),</span></span>
<span id="cb353-19"><a href="#cb353-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">#panel.spacing.y = unit(0.5, "cm"),</span></span>
<span id="cb353-20"><a href="#cb353-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#panel.spacing = unit(1, "lines"),</span></span>
<span id="cb353-21"><a href="#cb353-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb353-22"><a href="#cb353-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb353-23"><a href="#cb353-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'right'</span>,</span>
<span id="cb353-24"><a href="#cb353-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plot.title = element_text(size = 11),</span></span>
<span id="cb353-25"><a href="#cb353-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb353-26"><a href="#cb353-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axis.text.x = element_text(size = 12),</span></span>
<span id="cb353-27"><a href="#cb353-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>, <span class="at">hjust =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb353-28"><a href="#cb353-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb353-29"><a href="#cb353-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main.gg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-255-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>scale <span class="ot">=</span> <span class="fl">0.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>pkpd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> rpn_crw.main4, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> sst_max)) <span class="sc">+</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_y_continuous(breaks = c(5, 5), limits = c(0, 50)) +</span></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylim(0, 40) +</span></span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Maximum Sea Surface Temperature"</span>)) <span class="sc">+</span></span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> dhw <span class="sc">*</span> scale, <span class="at">color =</span> <span class="st">"Degree Heating Week"</span>))<span class="sc">+</span></span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_x_continuous(breaks = seq(0, 336, 24)) +</span></span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span>scale, <span class="at">name =</span> <span class="st">"DHW"</span>)) <span class="sc">+</span></span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"SST Max (C)"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange2"</span>, <span class="st">"gray50"</span>))</span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pkpd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-257-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the second y axis by </span></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   - subtracting its minimum value (to set it to start at 0)</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   - scaling so that it has the same range as the 'y1' variable</span></span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   - offsettting it by the minimum value of y1</span></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>a            <span class="ot">&lt;-</span> <span class="fu">range</span>(rpn_crw.main4[[<span class="st">'sst_max'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.39 26.99</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>b            <span class="ot">&lt;-</span> <span class="fu">range</span>(rpn_crw.main4[[<span class="st">'dhw'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>scale_factor <span class="ot">&lt;-</span> <span class="fu">diff</span>(a)<span class="sc">/</span><span class="fu">diff</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>rpn_crw.main4[[<span class="st">'sst_max'</span>]]      <span class="ot">&lt;-</span> ((rpn_crw.main4[[<span class="st">'sst_max'</span>]] <span class="sc">-</span> b[<span class="dv">1</span>]) <span class="sc">*</span> scale_factor) <span class="sc">+</span> a[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to define the second axis transformation to be the inverse of the data</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a><span class="co"># transformation to everything cancels out appropriately</span></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>trans <span class="ot">&lt;-</span> <span class="er">~</span> ((. <span class="sc">-</span> a[<span class="dv">1</span>]) <span class="sc">/</span> scale_factor) <span class="sc">+</span> b[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>pkpd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> rpn_crw.main4, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> sst_max)) <span class="sc">+</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_y_continuous(breaks = c(5, 5), limits = c(0, 50)) +</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylim(0, 40) +</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Maximum Sea Surface Temperature"</span>)) <span class="sc">+</span></span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> dhw <span class="sc">*</span> scale, <span class="at">color =</span> <span class="st">"Degree Heating Week"</span>))<span class="sc">+</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_x_continuous(breaks = seq(0, 336, 24)) +</span></span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="at">trans =</span> trans, <span class="at">name =</span> <span class="st">'dhw'</span>), </span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500</span>)) <span class="sc">+</span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"SST Max (C)"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange2"</span>, <span class="st">"gray50"</span>))</span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pkpd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="bleaching_results_supp_material2_files/figure-html/unnamed-chunk-264-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">"https://coralreefwatch.noaa.gov/product/vs/data/easter_island.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 14023 Columns: 1
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr (1): Name:

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
  `Name:`                       
  &lt;chr&gt;                         
1 Easter Island, Chile          
2 Polygon Middle Longitude:     
3 -109.3250                     
4 Polygon Middle Latitude:      
5 -27.1750                      
6 Averaged Maximum Monthly Mean:</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(rpn_crw, <span class="st">".csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© CC-1.0</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>